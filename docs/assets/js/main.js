"use strict";let searchSeries,showSeries,showFavorites,addFavorites,addToLs,getToLs,reset,closeFav,listenClose,buttonElement=document.querySelector(".js-button"),inputElement=document.querySelector(".js-input"),searchContainer=document.querySelector(".js-searchContainer"),favContainer=document.querySelector(".js-favContainer"),resetBtn=document.querySelector(".js-reset"),series=[],favoritesSeries=[];addToLs=function(){localStorage.setItem("favorite",JSON.stringify(favoritesSeries))},(getToLs=function(){favoritesSeries=JSON.parse(localStorage.getItem("favorite"))||[]})(),searchSeries=function(e){getToLs(),e.preventDefault(),fetch(`http://api.tvmaze.com/search/shows?q=${inputElement.value}`).then(function(e){return e.json()}).then(function(e){(series=e).length>0?showSeries(series):console.log("No hemos encontrado datos")}).catch(function(e){console.log("Error al traer los datos del servidor",e)})},showSeries=function(e){let t,s,r,i,o;searchContainer.innerHTML="",(t=document.createElement("ul")).classList.add("js-series");for(let a of e){(s=document.createElement("li")).classList.add("js-li");for(let e=0;e<favoritesSeries.length;e++)`${a.show.id}`===favoritesSeries[e].id&&s.classList.toggle("js-selected");(r=document.createElement("img")).classList.add("js-img"),null!==a.show.image?r.src=a.show.image.medium:r.src="https://via.placeholder.com/210x295/ffffff/666666/?text = TV",(i=document.createElement("h3")).classList.add("js-title"),o=document.createTextNode(`${a.show.name}`),s.id=a.show.id,s.setAttribute("serieId",a.show.id),i.appendChild(o),s.appendChild(r),s.appendChild(i),s.addEventListener("click",addFavorites),s.addEventListener("click",showFavorites),t.appendChild(s)}searchContainer.appendChild(t)},showFavorites=function(){let e,t,s,r,i,o,a;favContainer.innerHTML="",(e=document.createElement("ul")).classList.add("js-favorites");for(let n of favoritesSeries)(t=document.createElement("li")).classList.add("js-NewLi"),(s=document.createElement("img")).classList.add("js-newImg"),null!==n.img?s.src=n.img:s.src="https://via.placeholder.com/210x295/ffffff/666666/?text = TV",(r=document.createElement("h3")).classList.add("js-NewTitle"),i=document.createTextNode(`${n.title}`),t.id=n.id,(o=document.createElement("button")).classList.add("js-closeBtn"),o.setAttribute("serieId",n.id),a=document.createTextNode("X"),o.appendChild(a),r.appendChild(i),t.appendChild(s),t.appendChild(r),t.appendChild(o),e.appendChild(t),o.addEventListener("click",addFavorites);favContainer.appendChild(e)},addFavorites=function(e){let t,s={},r=!1;t=e.currentTarget.getAttribute("serieId");for(let e=0;e<favoritesSeries.length;e++)t===favoritesSeries[e].id&&(favoritesSeries.splice(e,1),r=!0);r||(e.currentTarget.classList.toggle("js-selected"),s.id=e.currentTarget.getAttribute("serieId"),s.img=e.currentTarget.querySelector(".js-img").src,s.title=e.currentTarget.querySelector(".js-title").innerHTML,favoritesSeries.push(s)),showSeries(series),showFavorites(),addToLs()},reset=function(){favoritesSeries=[],showSeries(series=[]),showFavorites(),addToLs()},showFavorites(),buttonElement.addEventListener("click",searchSeries),resetBtn.addEventListener("click",reset);